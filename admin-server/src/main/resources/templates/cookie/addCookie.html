<!doctype html>
<html th:replace="~{layout/main :: layout(~{::title}, ~{::div#layout-container-page})}" xmlns:th="http://www.thymeleaf.org">
<head></head>
<body>
  <div id="layout-container-page" class="max-w-2xl mx-auto">
    <!-- Header Section -->
    <div class="mb-8">
      <div class="flex items-center space-x-2 text-sm text-muted-foreground mb-4">
        <a href="/cookies" class="hover:text-foreground transition-colors">Cookies</a>
        <i class="bx bx-chevron-right h-4 w-4"></i>
        <span class="text-foreground">Add Cookie</span>
      </div>
      <div class="space-y-1">
        <h1 class="text-3xl font-bold tracking-tight">Add New Cookie</h1>
        <p class="text-muted-foreground">Create a new cookie entry for site authentication</p>
      </div>
    </div>

    <!-- Main Form Card -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">Cookie Information</div>
        <div class="card-description">Enter the details for the new cookie</div>
      </div>
      
      <div class="card-content space-y-6">
        <form th:action="@{/addCookie}" th:object="${cookie}" method="post" class="space-y-6">
          
          <!-- Global Errors -->
          <div th:if="${#fields.hasGlobalErrors()}" class="space-y-2">
            <div class="alert alert-danger" th:each="err : ${#fields.globalErrors()}">
              <i class="bx bx-error-circle h-4 w-4 mr-2"></i>
              <span th:text="${err}">Global error message</span>
            </div>
          </div>

          <!-- User Name Field -->
          <div class="space-y-2">
            <label for="userName" class="label" th:text="#{cookie.userName}">User Name</label>
            <input 
              type="text" 
              id="userName" 
              th:field="*{userName}"
              th:classappend="${#fields.hasErrors('userName')} ? 'border-destructive' : ''"
              class="input" 
              placeholder="Enter your username"
              autofocus
            />
            <div th:if="${#fields.hasErrors('userName')}" class="form-error">
              <i class="bx bx-error-circle h-4 w-4 mr-1"></i>
              <span th:errors="*{userName}">Username error</span>
            </div>
          </div>

          <!-- Site Name Field -->
          <div class="space-y-2">
            <label for="siteName" class="label" th:text="#{cookie.siteName}">Site Name</label>
            <select 
              th:field="*{siteName}" 
              id="siteName" 
              class="select"
            >
              <option value="">Select a site...</option>
              <option th:each="name : ${siteName}" th:value="${name}" th:text="${name}">Site Name</option>
            </select>
          </div>

          <!-- Cookie Value Field -->
          <div class="space-y-2">
            <label for="cookie" class="label" th:text="#{cookie.cooke}">Cookie Value</label>
            <textarea 
              id="cookie" 
              th:field="*{cookie}"
              th:classappend="${#fields.hasErrors('cookie')} ? 'border-destructive' : ''"
              class="textarea min-h-[100px]" 
              placeholder="Paste your cookie value here..."
            ></textarea>
            <div class="form-description">
              Copy the cookie value from your browser's developer tools
            </div>
            <div th:if="${#fields.hasErrors('cookie')}" class="form-error">
              <i class="bx bx-error-circle h-4 w-4 mr-1"></i>
              <span th:errors="*{cookie}">Cookie error</span>
            </div>
          </div>

        </form>
      </div>
      
      <!-- Form Actions -->
      <div class="card-footer">
        <div class="flex items-center justify-between">
          <button type="button" class="btn btn-outline" th:onclick="|location.href='@{/cookies}'|">
            <i class="bx bx-arrow-back h-4 w-4 mr-2"></i>
            Back to List
          </button>
          <div class="flex items-center space-x-3">
            <button type="button" class="btn btn-ghost" onclick="resetForm()">
              <i class="bx bx-refresh h-4 w-4 mr-2"></i>
              Reset
            </button>
            <button type="submit" form="cookie-form" class="btn btn-default">
              <i class="bx bx-save h-4 w-4 mr-2"></i>
              Save Cookie
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Information Card -->
    <div class="card mt-6">
      <div class="card-content">
        <div class="flex items-start space-x-3">
          <div class="flex h-8 w-8 items-center justify-center rounded-full bg-blue-50 mt-1">
            <i class="bx bx-info-circle h-4 w-4 text-blue-600"></i>
          </div>
          <div class="space-y-1">
            <h3 class="font-medium text-sm">How to get cookie values</h3>
            <p class="text-sm text-muted-foreground">
              1. Open your browser's developer tools (F12)<br/>
              2. Go to the Network tab or Application tab<br/>
              3. Find the cookie section and copy the value<br/>
              4. Make sure to copy the complete cookie string
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Update form id
    document.querySelector('form').id = 'cookie-form';
    
    function resetForm() {
      document.getElementById('cookie-form').reset();
      // Remove any error states
      document.querySelectorAll('.border-destructive').forEach(el => {
        el.classList.remove('border-destructive');
      });
    }

    // Form validation feedback
    document.getElementById('cookie-form').addEventListener('submit', function(e) {
      const submitBtn = document.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<i class="bx bx-loader-alt bx-spin h-4 w-4 mr-2"></i>Saving...';
      
      // Re-enable button after 3 seconds if form doesn't submit
      setTimeout(() => {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalText;
      }, 3000);
    });
  </script>

</body>
</html>
